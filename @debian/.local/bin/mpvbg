#!/bin/sh

# Play a video on the root window
# Credits: http://github.com/mitchweaver/bin
# @TODO: https://github.com/joshua-sterner/mpvbg/blob/master/mpvbg.sh

command -v xwinwrap >/dev/null 2>&1 || {
    echo >&2 "Please install first xwinwrap (https://github.com/ujjwal96/xwinwrap). Aborting."; exit 1;
}

[ -f "$1" ] || exit 1

pkill -9 xwinwrap

xwin="xwinwrap -ni -sh rectangle -b -nf -ov -fs -- "

mpv="mpv --wid WID --no-config --keepaspect=no --loop \
    --no-border --vd-lavc-fast --x11-bypass-compositor=no \
    --gapless-audio=yes --vo=xv --hwdec=auto --really-quiet \
    --name=mpvbg"

$xwin $mpv "$1" > /dev/null 2>&1 &
echo -n $! > ${HOME}/.cache/mpvbg.pid
