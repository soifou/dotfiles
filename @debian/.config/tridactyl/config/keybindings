" Default keybinds: https://github.com/tridactyl/tridactyl/blob/master/src/lib/config.ts

" Reload conf on the fly
bind ,s source ~/.config/tridactyl/tridactylrc

" Open command prompt
unbind :
bind ,; fillcmdline_notrail
" Allow to copy in the commandline
unbind --mode=ex <C-c>

" Navigation
unbind H
unbind J
unbind K
unbind L

bind h back
bind l forward
bind gu urlparent
bind gU urlroot

bind H scrollpx -45
bind L scrollpx +45

bind J zoom 0.1 true
bind K zoom -0.1 true

bind [ tabprev
bind ] tabnext

bind { followpage prev
bind } followpage next


" Find in page
bind / fillcmdline find
bind <C-f> fillcmdline find
bind n findnext 1
bind p findnext -1
bind ,/ nohlsearch
set findcase smart


" Play video with mpv
 " unbind v
unbind V
" On current URL
bind V composite get_current_url | exclaim_quiet mpv
" Using hint
" bind v hint -JW mpv
bindurl youtube.com v composite hint -Jpipe ytd-thumbnail>a href | exclaim_quiet mpv
bindurl dailymotion.com v composite hint -Jpipe a href | exclaim_quiet mpv

" Open link in reader mode
" bind --mode=normal ,q composite hint -pipe a href | jsb -p tri.excmds.tabopen("about:reader?url=" + JS_ARG)

" Open link in foreground tab
unbind F
bind F hint -t

" Open link in new window
unbind w
bind w hint -w

" RSS (show feeds in current page and prompt if more than one found)
alias rsssave js -p tri.excmds.shellescape(JS_ARG).then(url => tri.excmds.exclaim_quiet('echo ' + url + ' >> ~/.config/newsboat/urls; notify-send -i RSS_feeds Newsboat Subscribed'))
set rsscmd rsssave %u
" Subscribe to YouTube channels too
alias ytrss js -p tri.excmds.shellescape(JS_ARG).then(url => tri.excmds.exclaim_quiet('yt-rss ' + url + ' >> ~/.config/newsboat/urls; notify-send -i RSS_feeds Newsboat Subscribed'))
bindurl youtube.com n composite get_current_url | ytrss
bind ,r composite rssexec

" Editor
" Focus an input field, then <C-e> (default <C-i>)
" will start vim instance with content of the input (or blank)
set editorcmd kitty --class floating $EDITOR %f
bind --mode=insert <C-e> editor
bind --mode=input <C-e> editor
" Uncomment to trigger editor directly on focus
" bind --mode=normal gi composite focusinput -l | editor

" Toggle pinned tab
bind ,p pin

" Mimic native Firefox url edition
bind <C-l> current_url open

" Git{Hub,Lab} git clone via SSH yank
bind yg composite js "git clone " + document.location.href.replace(/https?:\/\//,"git@").replace("/",":").replace(/$/,".git") | clipboard yank

